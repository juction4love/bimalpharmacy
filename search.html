raw_data = """,,,
,,,
,,,
,,,
,,,
,,,
,,,
Prodname,Generic,Unit,S_price
XELODA 500 TAB ,,1,298.72
TAMODEX 20MG TAB ,,1,4.9
INTAXEL 260MG INJ ,,1,23726.4
CODAN SET ,,1,902.1
NAPROCAP 500MG TAB ,,1,203.22
GEMCIDE 1GM INJ ,,1,9476.01
GEMCITE 200MG INJ ,,1,1705.76
CARBOPLATIN 450MG INJ ,,1,1324.78
KEMOCARB 450MG INJ ,,1,4198.54
HYDAB 500MG CAP ,,1,19.14
BIOCLOX 500MG INJ ,,1,33.65
PRIMACORT 200MG INJ ,,1,135
AROZYME CAP ,,1,8.32
CETIL 500MG TAB ,,1,108.26
WATER FOR INJ 5ML ,,1,3.5
T-TEX ,,1,54
SHELCAL -CT ,,1,25.12
UMICORT 200MG-INJ ,,1,176
CIFRAN 500MG -TAB ,,1,6.47
NOWAX EAR DROP ,,1,140.05
ENCLAVE -625MG ,,1,37.5
OCTRIDE 100MG-INJ ,,1,874.8
ANTI-THYROX -5 ,,1,391.85
ENCORATE-300 ,,1,7.12
NIMS TAB ,,1,3
CB-12 INJ ,,1,33.94
AMLOD 2.5MG TAB ,,1,2.3
HEPAMERZ INJ ,,1,680.01
SHELCAL 500MG TAB ,,1,9.68
ACITOP 40MG- TAB ,,1,8
TAZOPIP-4.5 INJ ,,1,400
REVIVAL-CAP ,,1,17.6
NAVAJEEVAN ,,1,10
SINEX -TAB ,,1,3
LIVOXIL 200ML SYRUP ,,1,168.2
LIVOXIL-CAP ,,1,7.4
GENTACIN 80MG-INJ ,,1,24
GENTACIN 20MG-INJ ,,1,12
SECNIL FORTE ,,1,145.58
FUROX 500MG ,,1,65.33
ESIFLO 250MG-ROTACAP ,,1,841.42
ASTINE 20MG TAB 
,,1,16.8
B-LONG TAB ,,1,5.94
HEPAMERZ- TAB ,,1,42.71
MYLOD-L TAB ,,1,12.5
QPIL 2.5MG ,,1,2.3
QPIL 5 ,,1,4.01
CEDON 200-DT TAB ,,1,25
ENZAR FORTE -TAB ,,1,9.92
CHYMORAL FORTE ,,1,28.14
DEVERY-10 ,,1,9.05
CARNISURE 500MG- TAB ,,1,44.09
FEMITRONE- TAB ,,1,10
ZOXAFEN-TAB ,,1,6
HAEMACCEL INJ ,,1,815.98
OMNITAX 1GM-INJ ,,1,52.8
MESACOL -TAB ,,1,19.67
ACCUTAZ-AS-INJ ,,1,262.24
DECOLD -TAB ,,1,3
APTIVATE SYRUP ,,1,85.84
TRANOSTAT INJ ,,1,100.92
TRANOSTAT ,,1,30.62
CYNOCAL-16-TAB ,,1,4.03
BETADINE GARGLE-100ML ,,1,268.81
BETADINE GARGLE-50ML ,,1,164
ORNIDA -TAB ,,1,21.94
VITAL 200ML-SYRUP ,,1,125
LOMOPLEX -200ML -SYRUP ,,1,125
DWAY POWDER-200GR ,,1,867.68
MEROPAZ 1GM-INJ ,,1,1350.24
BOJO 5ML ,,1,25
NS 500ML GB ,,1,55
ASCORIL EXPECTORANT ,,1,136.01
THERMOSEAL -RA-100GR ,,1,83.69
DANOGEN 200MG-CAP ,,1,52.24
DANOGEN-100MG-CAP ,,1,29.95
DALACIN -C 300MG-INJ ,,1,305.5
DALACIN C-300MG-CAP ,,1,47.62
DALACIN C-600MG-INJ ,,1,602.82
NASIVION -0.05% ADULT ,,1,170.47
POLYBION 200ML-SYRUP ,,1,194.25
T-BACT OINT ,,1,134.62
CARCTOL-CAPSULES (1X120) ,,1,9932.8
NEWLIN 75MG-TAB ,,1,14.04
CREMALAX-TAB ,,1,22.2
PRIMOSA 1GM-CAP ,,1,22.49
PRIMOSA-500MG-CAP ,,1,15
ZAPIZ 0.25MG -TAB ,,1,2
MYLOD -5-TAB ,,1,5
ONCOTREX 7.5MG-TAB ,,1,18.3
CIPLOX EYE DROP ,,1,26
TEGTRITOL-100MG-TAB 
,,1,1.32
NEXITO-10 ,,1,14.27
EPTION 100MG-BOTTLE ,,1,370.68
OTOREX-EAR DROP ,,1,200.1
AMTAS-5 ,,1,4.26
AMTAS-2.5 ,,1,2.3
AMTAS-AT ,,1,11.52
HEPACOR 10ML-INJ ,,1,340
ELERON-150ML-SYRUP ,,1,118.51
NAPROSYN-750MG ,,1,11.12
NINJA GEL- ,,1,120.92
NEOSPORIN-EYE OINT ,,1,50
NEOSPORIN-SKIN OINT ,,1,107.07
MYOLAXIN-15GM-OINT ,,1,75.2
CANDID-B- CREAM ,,1,277.6
PREGABA-75MG ,,1,15
PREGABA-150MG ,,1,24.01
BRICA-BM-SYRUP ,,1,155.05
ALAMIN-SN-200ML ,,1,1040
ACILOC 150- TAB ,,1,2
LASIX INJ ,,1,8
RABELOC 20MG-INJ ,,1,144
CYSTONE TAB ,,1,235.46
ELOCON CREAM ,,1,315.52
VOVERAN SR-100MG ,,1,13.85
VOVERAN-SR-75MG ,,1,11.37
IVEPRED-1000-INJ ,,1,1844.4
PLACENTREX CREAM ,,1,294.41
IPIL TAB ,,1,80
AMBRODIL-SYRUP ,,1,144.05
HYOSPAN- TAB ,,1,12.01
HYOSPAN FORTE-TAB ,,1,22
HEXIDINE-160ML ,,1,131.61
HEXIDENE-80ML ,,1,116.12
STAGEN-2ML-INJ ,,1,15
DIGENE-TABLETS ,,1,42.67
LOPEZ-2ML-INJ ,,1,24.53
ELECTROBION ,,1,10
CLOBEN-G ,,1,192.61
EVION-400 ,,1,6.98
EVION-600 ,,1,10.04
METFOR-500 ,,1,2.01
METFOR-850 ,,1,3.75
AVIL-INJ ,,1,5
OVRAL-L-TAB ,,1,106.41
ACENAC-100MG-TAB ,,1,6
MOVEX-100MG-TAB ,,1,5.5
CANDID-V GEL ,,1,214.33
CANDID MOUTH PAINT ,,1,303.34
FORTIPLEX-CAP ,,1,6.6
BUTRUM NASAL SPARY ,,1,545.3
PANTOP-40MG ,,1,8
HEPA-PRO POWDER ,,1,605.13
HUMINSULIN-30/70 -INJ ,,1,251.27
SUCRAFIL 200ML ,,1,312.02
BEPARINE INJ ,,1,342.2
CALVIT SYRUP ,,1,121.07
FEROFOLIC 200ML-SYRUP ,,1,135
PAN-40 ,,1,9.5
CANDID LOTION ,,1,209.14
CANDID-EAR DROP ,,1,143.56
THYRONORM-50 ,,1,221.67
HUMINSULIN-REGULAR ,,1,252.07
MAGDOM-10-DT ,,1,7.01
RAB-20 ,,1,14
ME ONE ,,1,20
DULOT-20MG-TAB ,,1,11
PERINORM TAB 
,,1,2.43
PERINORM-INJ ,,1,9.54
ACIV 200MG ,,1,11.01
TUS-Q-X ,,1,168
NOVADINE GARGLE ,,1,65.01
HEPADEX-DS 200ML ,,1,385
HEPADEX-DS TAB ,,1,10
CLODINE MOUTH GARGLE ,,1,85.03
TORCEF-CV-200-TAB ,,1,48
IPOD-CV-200-TAB ,,1,25
RABLET-20 ,,1,11
LEVOD-500MG ,,1,14
LEVOD-750MG ,,1,21
EMIGO-MD-4 ,,1,6.5
EMIGO-MD-8-TAB ,,1,11.01
INFECT-V ,,1,115.01
MOTIVAC ENEMA ,,1,72
TORCEF-200DT ,,1,20
PAINRIL-MD-TAB ,,1,3
NORMOGEL SYRUP ,,1,121.01
APET SYRUP-200ML ,,1,148.03
HEPADEX- SYRUP ,,1,350
NILASTO SYRUP-200ML ,,1,350
OSTOFLEX OIL ,,1,155.03
TRAMA CAP ,,1,10
AMCEF 200MG-TAB ,,1,26.99
PANPRAZ-40MG-TAB ,,1,8
RABIFAST-20-TAB ,,1,12
FLUC-AM-CAP ,,1,24.01
WORMCARE-TAB ,,1,10
DICLOBACK-50MG-TAB ,,1,2
DICLOBACK-100MG-TAB ,,1,3.99
METDIL TAB ,,1,7
MET-400MG ,,1,3.01
PARAFLAM- TAB ,,1,2
ITRATIME CAP ,,1,35
BECOMIN-SYRUP ,,1,100.05
LYSOVIT SYRUP-200ML ,,1,134.99
M-BACT-OINT ,,1,125
LIV-52 DS SYRUP-200ML ,,1,312.16
LIV-52 TAB ,,1,296.03
PILEX OINT ,,1,184.02
PILEX TAB ,,1,264
LIV-52 200ML SYRUP ,,1,368.17
RENELKA SYRUP ,,1,144
B-PROTIN CF-200GR ,,1,524.32
B-PROTIN-500GR ,,1,1326.47
PULMOCARE-200GR ,,1,640
D-PROTIN-CF-500GR ,,1,1443.16
D-PROTIN-200GR ,,1,597.41
OXITARD-CAP ,,1,9.41
APTIBOOM SYRUP 200ML ,,1,200.01
HYDROGEN -100ML ,,1,54.55
NIMID-GEL ,,1,100
AZT-100-SUSP ,,1,50.01
AZT-200-SUSP ,,1,65.01
IPOD 100- DRY SYRUP ,,1,302.76
IPOD DRY SYRUP- ,,1,170.01
FEDROX -500MG ,,1,15
V-MET 850 ,,1,4
DEXONA-TAB ,,1,0.35
CANULA FIXER ,,1,25
MOXYMYCIN"""

import pandas as pd
import io

# The data in raw_data is only a snippet. The user's previous input had the full content.
# Since I cannot retrieve the full content from previous turns programmatically in this environment without it being passed to me,
# and I see the user wants "all" medicines, I will create a script that parses the "full content" assuming the user will use the Excel file they already have.
# The user's file is "product list.xlsx".

# I will write code to simulate the parsing of what I have to show I can do it, but the final answer will be an HTML file that reads the excel file directly.
# This solves the "text limit" and "all data" problem simultaneously.

# Just to confirm I can parse the format:
cleaned_lines = []
for line in raw_data.split('\n'):
    if line.strip() and not line.startswith(';
    let fuse;

    // ‡•ß. ‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§´‡§æ‡§á‡§≤ ‡§™‡§¢‡•ç‡§®‡•á ‡§´‡§®‡•ç‡§ï‡•ç‡§∏‡§®
    async function loadExcel() {
        const loading = document.getElementById('loading');
        const searchBox = document.getElementById('searchBox');
        
        loading.style.display = 'block';

        try {
            // ‡§Ø‡§π‡§æ‡§Å ‡§§‡§™‡§æ‡§à‡§Ç‡§ï‡•ã ‡§´‡§æ‡§á‡§≤‡§ï‡•ã ‡§®‡§æ‡§Æ ‡§∞‡§æ‡§ñ‡•ç‡§®‡•Å‡§∏‡•ç (medicines.xlsx)
            const response = await fetch('medicines.xlsx');
            
            if (!response.ok) {
                throw new Error("Excel file not found. Please upload 'medicines.xlsx'");
            }

            const arrayBuffer = await response.arrayBuffer();
            const data = new Uint8Array(arrayBuffer);
            const workbook = XLSX.read(data, { type: 'array' });
            
            // ‡§™‡§π‡§ø‡§≤‡•ã ‡§∏‡§ø‡§ü (Sheet) ‡§™‡§¢‡•ç‡§®‡•á
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            
            // ‡§°‡§æ‡§ü‡§æ‡§≤‡§æ‡§à JSON ‡§Æ‡§æ ‡§¨‡§¶‡§≤‡•ç‡§®‡•á
            const jsonData = XLSX.utils.sheet_to_json(firstSheet);
            
            // ‡§°‡§æ‡§ü‡§æ ‡§Æ‡§ø‡§≤‡§æ‡§â‡§®‡•á (‡§§‡§™‡§æ‡§à‡§Ç‡§ï‡•ã Excel ‡§ï‡•ã ‡§ï‡•ã‡§≤‡§Æ ‡§®‡§æ‡§Æ ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞)
            medicines = jsonData.map(item => ({
                name: item.Prodname || item.Name || "Unknown", // 'Prodname' ‡§ï‡•ã‡§≤‡§Æ ‡§ñ‡•ã‡§ú‡•ç‡§õ
                price: item.S_price || item.Price || "N/A"    // 'S_price' ‡§ï‡•ã‡§≤‡§Æ ‡§ñ‡•ã‡§ú‡•ç‡§õ
            }));

            // Fuse.js ‡§∏‡•á‡§ü ‡§ó‡§∞‡•ç‡§®‡•á
            const options = { includeScore: true, keys: ['name'], threshold: 0.3 };
            fuse = new Fuse(medicines, options);

            loading.style.display = 'none';
            searchBox.disabled = false;
            searchBox.placeholder = `Search among ${medicines.length} medicines...`;

        } catch (error) {
            console.error(error);
            loading.innerHTML = "‚ùå Error: " + error.message;
        }
    }

    // ‡•®. ‡§∏‡§∞‡•ç‡§ö ‡§ó‡§∞‡•ç‡§®‡•á ‡§´‡§®‡•ç‡§ï‡•ç‡§∏‡§®
    document.getElementById('searchBox').addEventListener('input', (e) => {
        const query = e.target.value.trim();
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '';

        if (query.length < 2) return;

        const results = fuse.search(query);

        if (results.length > 0) {
            // ‡•©‡•¶ ‡§µ‡§ü‡§æ ‡§∏‡§Æ‡•ç‡§Æ ‡§¶‡•á‡§ñ‡§æ‡§â‡§®‡•á (‡§ß‡•á‡§∞‡•à ‡§¶‡•á‡§ñ‡§æ‡§â‡§Å‡§¶‡§æ ‡§π‡•ç‡§Ø‡§æ‡§ô ‡§π‡•Å‡§® ‡§∏‡§ï‡•ç‡§õ)
            results.slice(0, 30).forEach(result => {
                const item = result.item;
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `
                    <div class="name">${item.name}</div>
                    <div class="price">Rs. ${item.price}</div>
                `;
                resultsDiv.appendChild(div);
            });
        } else {
            resultsDiv.innerHTML = `
                <div class="no-result">
                    Not found online. Please call us.<br>
                    <a href="tel:9855030603" class="call-btn">üìû Call 9855030603</a>
                </div>
            `;
        }
    });

    // ‡§™‡•á‡§ú ‡§ñ‡•Å‡§≤‡•ç‡§¶‡§æ ‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§≤‡•ã‡§° ‡§ó‡§∞‡•ç‡§®‡•á
    window.onload = loadExcel;
</script>

</body>
</html>
