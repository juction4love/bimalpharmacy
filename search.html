<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>औषधी खोज्नुहोस् - विमल फार्मेसी</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* Shared Styles */
        body { font-family: 'Arial', sans-serif; margin: 0; background-color: #87CEEB; background-image: linear-gradient(rgba(255,255,255,0.7), rgba(255,255,255,0.7)); }
        header { background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://raw.githubusercontent.com/juction4love/bimalpharmacy/main/heading.png'); background-size: cover; color: white; padding: 40px; text-align: center; border-bottom: 5px solid #4CAF50; }
        nav { text-align: center; background: #fff; padding: 15px; position: sticky; top: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        nav a { text-decoration: none; color: #4CAF50; margin: 0 15px; font-weight: bold; }
        .main-container { max-width: 1100px; margin: 30px auto; display: flex; gap: 20px; padding: 0 20px; }
        .content-column { flex: 3; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        input[type="text"] { width: 100%; padding: 12px; margin: 20px 0; border: 1px solid #ddd; border-radius: 4px; }
        .med-item { padding: 15px; border-bottom: 1px solid #eee; }
        .med-item:hover { background: #f9f9f9; }
        footer { background: #4CAF50; color: white; text-align: center; padding: 15px; margin-top: 40px; }
    </style>
</head>
<body>
    <header><h1>औषधी खोज्नुहोस्</h1></header>
    <nav>
        <a href="index.html">गृहपृष्ठ</a>
        <a href="search.html">खोज्नुहोस्</a>
        <a href="products.html">सेवाहरू</a>
        <a href="about.html">सूचना</a>
        <a href="contact.html">सम्पर्क</a>
    </nav>
    <div class="main-container">
        <section class="content-column">
            <h2>Search Medicine Database</h2>
            <input type="text" id="searchInput" placeholder="औषधीको नाम लेख्नुहोस् (e.g. Cetamol)..." onkeyup="searchMed()">
            <div id="loading" style="color:#4CAF50;">डाटा लोड हुँदैछ... (Loading Database)</div>
            <div id="results"></div>
        </section>
    </div>
    <script>
        let medicineList = [];
        async function loadExcel() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/juction4love/bimalpharmacy/main/medicine.xlsx');
                const data = await response.arrayBuffer();
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                medicineList = XLSX.utils.sheet_to_json(firstSheet);
                document.getElementById('loading').style.display = 'none';
            } catch (e) { document.getElementById('loading').innerText = "Error loading data."; }
        }
        function searchMed() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = "";
            if(query.length < 2) return;
            const filtered = medicineList.filter(m => Object.values(m).some(v => String(v).toLowerCase().includes(query)));
            filtered.forEach(m => {
                const div = document.createElement('div');
                div.className = 'med-item';
                div.innerHTML = `<strong>${m.Name || m.Medicine}</strong> - ${m.Category || ''} <br> <small>Price: ${m.Price || 'N/A'}</small>`;
                resultsDiv.appendChild(div);
            });
        }
        loadExcel();
    </script>
</body>
</html>
