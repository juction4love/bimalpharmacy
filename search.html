<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§î‡§∑‡§ß‡•Ä ‡§ñ‡•ã‡§ú‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç - ‡§µ‡§ø‡§Æ‡§≤ ‡§´‡§æ‡§∞‡•ç‡§Æ‡•á‡§∏‡•Ä</title>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3898364439256735"
      crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        /* --- GLOBAL STYLES --- */
        body {
            font-family: 'Kalimati', 'Arial', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            min-height: 100vh;
        }

        /* --- HEADER & NAV --- */
        header {
            background-color: #4CAF50; 
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('heading.png');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 40px 20px;
            text-align: center;
            border-bottom: 5px solid #388E3C;
        }
        header h1 { margin: 0; font-size: 3em; text-shadow: 2px 2px 4px #000; }

        nav {
            text-align: center;
            background-color: #fff;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        nav a {
            text-decoration: none;
            color: #4CAF50;
            margin: 0 10px;
            font-weight: bold;
        }
        nav a:hover { text-decoration: underline; }

        /* --- CONTAINER --- */
        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 20px;
        }

        /* --- 1. SEARCH ENGINE STYLE (Green) --- */
        .search-engine-box {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            text-align: center;
            border-top: 5px solid #4CAF50;
            margin-bottom: 40px;
        }

        .search-engine-box input {
            width: 70%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #4CAF50;
            border-radius: 4px;
        }

        .search-engine-box button {
            padding: 12px 25px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        .search-engine-box button:hover { background-color: #45a049; }

        /* Results Display Style */
        .result-item {
            background: #e8f5e9;
            border-left: 5px solid #4CAF50;
            padding: 15px;
            margin: 10px 0;
            text-align: left;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* --- 2. ORDER FORM STYLE (Orange) --- */
        .order-box-container {
            background-color: #fff8e1;
            border: 1px solid #ffe0b2;
            border-top: 5px solid #ff9800;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .order-box-container h2 {
            color: #e65100;
            margin-top: 0;
            border-bottom: 2px solid #ffcc80;
            padding-bottom: 10px;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ffcc80;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            font-weight: bold;
            color: #5d4037;
            margin-bottom: 5px;
        }

        .btn-send-mail {
            background-color: #e65100;
            color: white;
            padding: 15px;
            width: 100%;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        .btn-send-mail:hover { background-color: #bf360c; }

        /* --- FOOTER --- */
        footer {
            background-color: #145A32;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 50px;
        }
    </style>
</head>
<body>

    <header>
        <h1>‡§î‡§∑‡§ß‡•Ä ‡§ñ‡•ã‡§ú‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</h1>
        <p>Search & Order Medicines</p>
    </header>

    <nav>
        <a href="index.html">‡§ó‡•É‡§π‡§™‡•É‡§∑‡•ç‡§†</a>
        <a href="search.html" style="text-decoration: underline;">‡§ñ‡•ã‡§ú‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</a>
        <a href="products.html">‡§π‡§æ‡§Æ‡•ç‡§∞‡§æ ‡§∏‡•á‡§µ‡§æ‡§π‡§∞‡•Ç</a>
        <a href="about.html">‡§∏‡•Ç‡§ö‡§®‡§æ</a>
        <a href="contact.html">‡§∏‡§Æ‡•ç‡§™‡§∞‡•ç‡§ï ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</a>
    </nav>

    <div class="container">
        
        <div class="search-engine-box">
            <h3 style="color: #4CAF50; margin-top:0;">‡§°‡§æ‡§ü‡§æ‡§¨‡•á‡§∏‡§Æ‡§æ ‡§î‡§∑‡§ß‡•Ä ‡§ñ‡•ã‡§ú‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</h3>
            <p style="color:#666; font-size:14px;">‡§π‡§æ‡§Æ‡•ç‡§∞‡•ã ‡§∏‡•ç‡§ü‡§ï‡§Æ‡§æ ‡§≠‡§è‡§ï‡•ã ‡§î‡§∑‡§ß‡•Ä ‡§Ø‡§π‡§æ‡§Å ‡§ü‡§æ‡§á‡§™ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</p>
            
            <input type="text" id="searchInput" placeholder="Medicine Name (e.g. Cetamol)..." onkeyup="if(event.key === 'Enter') performSearch()">
            <button onclick="performSearch()">Search</button>
            
            <div id="searchResult" style="margin-top: 20px; color: #555;">
                </div>
        </div>


        <div class="order-box-container">
            <h2>üíä ‡§î‡§∑‡§ß‡•Ä ‡§≠‡•á‡§ü‡§ø‡§è‡§®? ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§∞‡•ç‡§°‡§∞ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç (Order Request)</h2>
            <p style="color: #666;">
                ‡§§‡§™‡§æ‡§à‡§Ç‡§≤‡•á ‡§ñ‡•ã‡§ú‡•ç‡§®‡•Å‡§≠‡§è‡§ï‡•ã ‡§î‡§∑‡§ß‡•Ä ‡§π‡§æ‡§Æ‡•ç‡§∞‡•ã ‡§°‡§æ‡§ü‡§æ‡§¨‡•á‡§∏‡§Æ‡§æ ‡§õ‡•à‡§® ‡§≠‡§®‡•á, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§§‡§≤‡§ï‡•ã ‡§´‡§æ‡§∞‡§Æ ‡§≠‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç‡•§
            </p>

            <form id="specialOrderForm">
                
                <label class="form-label">‡§§‡§™‡§æ‡§à‡§Ç‡§ï‡•ã ‡§®‡§æ‡§Æ (Your Name):</label>
                <input type="text" id="reqName" class="form-input" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç">

                <label class="form-label">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞ (Mobile Number):</label>
                <input type="tel" id="reqMobile" class="form-input" placeholder="98XXXXXXXX" required>

                <label class="form-label">‡§†‡•á‡§ó‡§æ‡§®‡§æ (Address):</label>
                <input type="text" id="reqAddress" class="form-input" placeholder="‡§ü‡•ã‡§≤, ‡§µ‡§°‡§æ ‡§®‡§Ç, ‡§†‡§æ‡§â‡§Å...">

                <label class="form-label">‡§î‡§∑‡§ß‡•Ä‡§ï‡•ã ‡§®‡§æ‡§Æ (Medicine Name):</label>
                <input type="text" id="reqMedicine" class="form-input" placeholder="‡§î‡§∑‡§ß‡•Ä‡§ï‡•ã ‡§®‡§æ‡§Æ">

                <button type="button" class="btn-send-mail" onclick="sendOrderEmail()">
                    ‚úâÔ∏è ‡§á‡§Æ‡•á‡§≤ ‡§™‡§†‡§æ‡§â‡§®‡•Å‡§π‡•ã‡§∏‡•ç (Send Email Order)
                </button>

            </form>
        </div>

    </div>

    <footer>
        <p>&copy; ‡•®‡•¶‡•®‡•´ ‡§µ‡§ø‡§Æ‡§≤ ‡§´‡§æ‡§∞‡•ç‡§Æ‡•á‡§∏‡•Ä‡•§ ‡§∏‡§∞‡•ç‡§µ‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§‡•§</p>
        
        <div style="margin-top: 10px; background: white; display: inline-block; padding: 5px; border-radius: 4px;">
             <img src="https://via.placeholder.com/100x30?text=Counter" alt="Counter">
        </div>
    </footer>

    <script>
        // ============================================
        // 1. EXCEL DATABASE SEARCH LOGIC
        // ============================================
        async function performSearch() {
            var query = document.getElementById("searchInput").value.toLowerCase();
            var resultsDiv = document.getElementById("searchResult");
            
            if (!query) {
                alert("Please enter a medicine name.");
                return;
            }

            resultsDiv.innerHTML = "<p>Reading Excel file... Please wait...</p>";

            try {
                // -----------------------------------------------------------
                // üî¥ IMPORTANT: REPLACE THE LINK BELOW WITH YOUR GITHUB RAW LINK
                // Example: https://raw.githubusercontent.com/USERNAME/REPO/main/medicine.xlsx
                // -----------------------------------------------------------
                const excelUrl = 'YOUR_GITHUB_RAW_EXCEL_LINK_HERE'; 
                // -----------------------------------------------------------

                const response = await fetch(excelUrl);
                
                if (!response.ok) {
                    throw new Error("Failed to fetch Excel file");
                }

                // Convert file to ArrayBuffer
                const arrayBuffer = await response.arrayBuffer();

                // Parse Excel Data using SheetJS
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });

                // Read the First Sheet
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];

                // Convert Sheet to JSON
                const jsonData = XLSX.utils.sheet_to_json(worksheet);

                // DEBUG: Log data to console to see column names
                console.log("Excel Data Loaded:", jsonData);

                // Filter Data
                // NOTE: This assumes your Excel has a column named "Name" or "Medicine". 
                // It searches ALL columns just in case.
                const filteredData = jsonData.filter(row => {
                    return Object.values(row).some(val => 
                        String(val).toLowerCase().includes(query)
                    );
                });

                // Display Results
                if (filteredData.length > 0) {
                    resultsDiv.innerHTML = ""; // Clear loading
                    filteredData.forEach(item => {
                        var div = document.createElement("div");
                        div.className = "result-item";
                        
                        // Construct the display string dynamically based on Excel Columns
                        let displayString = "";
                        for (const [key, value] of Object.entries(item)) {
                            displayString += `<strong>${key}:</strong> ${value} <br>`;
                        }
                        
                        div.innerHTML = displayString;
                        resultsDiv.appendChild(div);
                    });
                } else {
                    resultsDiv.innerHTML = "<p style='color:red;'>‚ùå Medicine not found. Please order below.</p>";
                }

            } catch (error) {
                console.error("Error:", error);
                resultsDiv.innerHTML = "<p style='color:red;'>Error loading database. Check the GitHub Link or Console.</p>";
            }
        }


        // ============================================
        // 2. EMAIL ORDER LOGIC
        // ============================================
        function sendOrderEmail() {
            var name = document.getElementById("reqName").value;
            var mobile = document.getElementById("reqMobile").value;
            var address = document.getElementById("reqAddress").value;
            var medicine = document.getElementById("reqMedicine").value;

            if(mobile === "") {
                alert("Please enter Mobile Number");
                return;
            }

            var emailTo = "contact@bimalpharmacy.com.np"; 
            var subject = "Order Request - " + name;
            
            var body = "Namaste Bimal Pharmacy,%0D%0A%0D%0A" +
                       "I want to order medicines:%0D%0A" +
                       "--------------------------------%0D%0A" +
                       "üë§ Name: " + name + "%0D%0A" +
                       "üìû Mobile: " + mobile + "%0D%0A" +
                       "üìç Address: " + address + "%0D%0A" +
                       "üíä Medicine: " + medicine + "%0D%0A" +
                       "--------------------------------";

            window.location.href = "mailto:" + emailTo + "?subject=" + subject + "&body=" + body;

            setTimeout(function() {
                alert("Your email app is opening...");
            }, 500);
        }
    </script>

</body>
</html>
